

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Tides on a simple 2D field &mdash; ESPIn2020 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tides on a randomly vegetated field" href="../RandomField2D/RandomField2D.html" />
    <link rel="prev" title="Sediment Erosion" href="../TidalFlow2ACO/TidalFlow2ACO_formatted_V2.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ESPIn2020
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../background/index.html">Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../TidalFlow2ACO/TidalFlow2ACO_formatted_V2.html">Sediment Erosion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../TidalFlow2ACO/TidalFlow2ACO_formatted_V2.html#questions-to-think-about">Questions to think about</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Tides on a simple 2D field</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#importing-and-installing">Importing and Installing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-parameters">Model Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-the-landlab-grid">Defining the Landlab Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-the-tidalflowcalculator-and-run-it">Instantiate the TidalFlowCalculator and run it</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initialize-the-particles-and-run-them">Initialize the particles and run them</a></li>
<li class="toctree-l3"><a class="reference internal" href="#make-visualizations">Make visualizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#animated-results">Animated Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../RandomField2D/RandomField2D.html">Tides on a randomly vegetated field</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../apiref/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESPIn2020</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Examples</a> &raquo;</li>
        
      <li>Tides on a simple 2D field</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/HomogeneousField2D/HomogeneousField2D.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="tides-on-a-simple-2d-field">
<h1>Tides on a simple 2D field<a class="headerlink" href="#tides-on-a-simple-2d-field" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we will be running the
<a class="reference external" href="http://landlab.github.io/">Landlab</a> tidal-flow-calculator over a
simple 2D field of constant depth and roughness. The domain used is a
modified version of one of the examples from <a class="reference external" href="https://github.com/landlab/landlab/blob/gt/tidal-flow-component/notebooks/tutorials/tidal_flow/tidal_flow_calculator.ipynb">this
notebook</a>.</p>
<div class="section" id="importing-and-installing">
<h2>Importing and Installing<a class="headerlink" href="#importing-and-installing" title="Permalink to this headline">¶</a></h2>
<p>First we will import some standard scientific Python libraries</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
<p>Next we need to install some libraries (including Landlab) to properly
accomplish this task.</p>
<p>As of this writing (8/18/2020) the tidal-flow-calculator is not part of
the core Landlab installation. As a consequence, we need to checkout the
feature branch containing the tidal-flow-calculator component
(<a class="reference external" href="https://github.com/landlab/landlab/tree/gt/tidal-flow-component">https://github.com/landlab/landlab/tree/gt/tidal-flow-component</a>). After
checking out or cloning this branch locally, <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">setup.py</span> <span class="pre">install</span></code>
should be run to build a new landlab installation containing the
tidal-flow-calculator.</p>
<p>To simulate passive particle transport we will use the Lagrangian-based
transport model <a class="reference external" href="https://github.com/passaH2O/dorado">dorado</a>. We can
install dorado by typing <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">pydorado</span></code> from the command line.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">landlab.components</span> <span class="kn">import</span> <span class="n">TidalFlowCalculator</span>
<span class="kn">from</span> <span class="nn">landlab</span> <span class="kn">import</span> <span class="n">RasterModelGrid</span>
<span class="kn">from</span> <span class="nn">dorado.routines</span> <span class="kn">import</span> <span class="n">plot_state</span>
</pre></div>
</div>
<p>Lastly there are some custom scripts containing functions we want to use
for this example. These scripts are available in the same directory as
this notebook, and so our imports will be happening locally.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">map_fun</span> <span class="kn">import</span> <span class="n">gridded_vars</span>
<span class="kn">from</span> <span class="nn">plot_fun</span> <span class="kn">import</span> <span class="n">group_plot</span>
<span class="kn">from</span> <span class="nn">plot_fun</span> <span class="kn">import</span> <span class="n">plot_depth</span>
<span class="kn">from</span> <span class="nn">particletransport</span> <span class="kn">import</span> <span class="n">init_particles</span>
<span class="kn">from</span> <span class="nn">particletransport</span> <span class="kn">import</span> <span class="n">tidal_particles</span>
</pre></div>
</div>
</div>
<div class="section" id="model-parameters">
<h2>Model Parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline">¶</a></h2>
<p>We are going to create model parameters that define the tidal scenario
for the tidal-flow-calculator as well as the random field properties.</p>
<p>First we will define the size of the domain (which is going to be a
rectangle) as well as the grid spacing, mean water depth, and properties
associated with the tide. In this 2D domain, the left and bottom
boundaries are closed.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">ncols</span> <span class="o">=</span> <span class="mi">250</span>
<span class="n">grid_spacing</span> <span class="o">=</span> <span class="mf">100.0</span>  <span class="c1"># m</span>
<span class="n">mean_depth</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># m</span>
<span class="n">tidal_range</span> <span class="o">=</span> <span class="mf">2.0</span>  <span class="c1"># m</span>
<span class="n">roughness</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># s/m^1/3, i.e., Manning&#39;s n</span>
<span class="n">tide_period</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="mi">60</span>  <span class="c1"># tidal period in seconds</span>
<span class="n">n_tide_periods</span> <span class="o">=</span> <span class="mi">15</span>  <span class="c1"># number of tidal periods to move particles around for</span>
</pre></div>
</div>
</div>
<div class="section" id="defining-the-landlab-grid">
<h2>Defining the Landlab Grid<a class="headerlink" href="#defining-the-landlab-grid" title="Permalink to this headline">¶</a></h2>
<p>Next we are going to be defining the Landlab grid object and its
associated parameters. Here the depth will be constant.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create and set up the grid</span>
<span class="n">grid</span> <span class="o">=</span> <span class="n">RasterModelGrid</span><span class="p">((</span><span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span><span class="p">),</span> <span class="n">xy_spacing</span><span class="o">=</span><span class="n">grid_spacing</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_zeros</span><span class="p">(</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">)</span>
<span class="n">z</span><span class="p">[:]</span> <span class="o">=</span> <span class="o">-</span><span class="n">mean_depth</span>
<span class="n">grid</span><span class="o">.</span><span class="n">set_closed_boundaries_at_grid_edges</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="instantiate-the-tidalflowcalculator-and-run-it">
<h2>Instantiate the TidalFlowCalculator and run it<a class="headerlink" href="#instantiate-the-tidalflowcalculator-and-run-it" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># instantiate the TidalFlowCalculator</span>
<span class="n">tfc</span> <span class="o">=</span> <span class="n">TidalFlowCalculator</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">tidal_range</span><span class="o">=</span><span class="n">tidal_range</span><span class="p">,</span>
                          <span class="n">tidal_period</span><span class="o">=</span><span class="n">tide_period</span><span class="p">,</span> <span class="n">roughness</span><span class="o">=</span><span class="n">roughness</span><span class="p">)</span>

<span class="c1"># run it</span>
<span class="n">tfc</span><span class="o">.</span><span class="n">run_one_step</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="initialize-the-particles-and-run-them">
<h2>Initialize the particles and run them<a class="headerlink" href="#initialize-the-particles-and-run-them" title="Permalink to this headline">¶</a></h2>
<p>Here we will specify where we want the particles to be initially placed
and the number of particles to use. Then we will allow them to move with
the tides.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># get gridded values</span>
<span class="n">gvals</span> <span class="o">=</span> <span class="n">gridded_vars</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

<span class="c1"># initialize the particle parameters</span>
<span class="n">seed_xloc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">180</span><span class="p">))</span>
<span class="n">seed_yloc</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">110</span><span class="p">))</span>
<span class="n">Np_tracer</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># use 100 particles</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">init_particles</span><span class="p">(</span><span class="n">seed_xloc</span><span class="p">,</span> <span class="n">seed_yloc</span><span class="p">,</span> <span class="n">Np_tracer</span><span class="p">,</span> <span class="n">grid_spacing</span><span class="p">,</span> <span class="n">gvals</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># move the particles with the tides</span>
<span class="n">walk_data</span> <span class="o">=</span> <span class="n">tidal_particles</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">tide_period</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">n_tide_periods</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="make-visualizations">
<h2>Make visualizations<a class="headerlink" href="#make-visualizations" title="Permalink to this headline">¶</a></h2>
<p>First we will visualize the domain, then the velocity components of the
ebb and flood tides. Afterwards we will plot the particle locations at
beginning and end of the simulation.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualize the domain</span>
<span class="n">plot_depth</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Water Depth&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_18_0.png" src="../../_images/output_18_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot velocity information</span>
<span class="n">group_plot</span><span class="p">(</span><span class="n">gvals</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_19_0.png" src="../../_images/output_19_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot particle locations on the roughness field</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># first plot initial locations as blue dots</span>
<span class="n">plot_state</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
           <span class="n">walk_data</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">target_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="c1"># then plot final locations as red dots</span>
<span class="n">plot_state</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">z</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)),</span>
           <span class="n">walk_data</span><span class="p">,</span> <span class="n">iteration</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">target_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="c1"># make the colorbar - yellow for high roughness, purple for low</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="c1"># tighten layout</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># show it</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/output_20_0.png" src="../../_images/output_20_0.png" />
</div>
<div class="section" id="animated-results">
<h2>Animated Results<a class="headerlink" href="#animated-results" title="Permalink to this headline">¶</a></h2>
<p>While the above still image is nice, it does not totally reflect how the
tides have influence the movement of the passive tracers. A better way
of visualizing this is by animating the movement of the particles at
each ebb and flood tide:</p>
<div class="figure align-center" id="id1">
<img alt="simple_2d_gif" src="../../_images/demo_Simple2D.gif" />
<p class="caption"><span class="caption-text">simple_2d_gif</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>With this visual we can see the oscillatory nature of the flow field and
the way in which the particles move with the tides.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../RandomField2D/RandomField2D.html" class="btn btn-neutral float-right" title="Tides on a randomly vegetated field" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../TidalFlow2ACO/TidalFlow2ACO_formatted_V2.html" class="btn btn-neutral float-left" title="Sediment Erosion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, CoastalTeam

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>