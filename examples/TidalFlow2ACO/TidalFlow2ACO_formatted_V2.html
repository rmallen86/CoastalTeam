

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Sediment Erosion &mdash; ESPIn2020 1.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Tides on a simple 2D field" href="../HomogeneousField2D/HomogeneousField2D.html" />
    <link rel="prev" title="Examples" href="../index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> ESPIn2020
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../background/index.html">Background</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sediment Erosion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#importing-and-installing">Importing and Installing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-parameters">Set parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#read-the-dem-to-create-a-grid-and-topography-field">Read the DEM to create a grid and topography field</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-vegetation-grid">Create vegetation grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#configure-boundaries">Configure boundaries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-variable-rougness-as-field-in-grid">Generate variable rougness as field in grid</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-a-tidalflowcalculator-component">Instantiate a TidalFlowCalculator component</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#assign-critical-shear-stress">Assign critical shear stress</a></li>
<li class="toctree-l4"><a class="reference internal" href="#create-grids">Create grids</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-mud-erodability">Set mud erodability</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-a-single-erosion-step">Run a single erosion step</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#save-original-bathy-topo-maps">Save original bathy &amp; topo maps</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#run-erosion-over-timesteps">Run erosion over timesteps</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#plot-topographic-elevation">Plot topographic elevation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-final-water-depths">Plot final water depths</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#questions-to-think-about">Questions to think about</a></li>
<li class="toctree-l2"><a class="reference internal" href="../HomogeneousField2D/HomogeneousField2D.html">Tides on a simple 2D field</a></li>
<li class="toctree-l2"><a class="reference internal" href="../RandomField2D/RandomField2D.html">Tides on a randomly vegetated field</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../apiref/index.html">API Reference</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">ESPIn2020</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../index.html">Examples</a> &raquo;</li>
        
      <li>Sediment Erosion</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/examples/TidalFlow2ACO/TidalFlow2ACO_formatted_V2.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="sediment-erosion">
<h1>Sediment Erosion<a class="headerlink" href="#sediment-erosion" title="Permalink to this headline">¶</a></h1>
<p>In this notebook we implement the erosion components of the matlab model
(Mariotti and Murshid, 2018) in the existing landlab tidal flow version.</p>
<div class="section" id="importing-and-installing">
<h2>Importing and Installing<a class="headerlink" href="#importing-and-installing" title="Permalink to this headline">¶</a></h2>
<p>First we will import some standard scientific Python libraries</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<p>Next we need to install some Landlab libraries to properly accomplish
this task</p>
<p>As of this writing (8/18/2020) the tidal-flow-calculator is not part of
the core Landlab installation. As a consequence, we need to checkout the
feature branch containing the tidal-flow-calculator component
(<a class="reference external" href="https://github.com/landlab/landlab/tree/gt/tidal-flow-component">https://github.com/landlab/landlab/tree/gt/tidal-flow-component</a>). After
checking out or cloning this branch locally, python setup.py install
should be run to build a new landlab installation containing the
tidal-flow-calculator.</p>
<p>We convert the matlab fuctions (totalsedimenterosionMUDsine.m) from
Mariotti and Murshid ( 2018) to python (tidal_erosion_calculator) to
calculate total sediment erosion.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">landlab.grid.mappers</span> <span class="kn">import</span> <span class="n">map_link_vector_components_to_node</span>
<span class="kn">from</span> <span class="nn">landlab</span> <span class="kn">import</span> <span class="n">RasterModelGrid</span><span class="p">,</span> <span class="n">imshow_grid</span>
<span class="kn">from</span> <span class="nn">landlab.components</span> <span class="kn">import</span> <span class="n">TidalFlowCalculator</span>
<span class="kn">from</span> <span class="nn">landlab.grid.mappers</span> <span class="kn">import</span> <span class="n">map_max_of_link_nodes_to_link</span>
<span class="kn">from</span> <span class="nn">landlab.io</span> <span class="kn">import</span> <span class="n">read_esri_ascii</span>
<span class="kn">import</span> <span class="nn">tidal_erosion_calculator</span> <span class="k">as</span> <span class="nn">tec</span>
</pre></div>
</div>
</div>
<div class="section" id="set-parameters">
<h2>Set parameters<a class="headerlink" href="#set-parameters" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#This set-up is from the MarshMorpho2D source code</span>
<span class="n">tidal_period</span> <span class="o">=</span> <span class="mf">12.5</span> <span class="o">*</span> <span class="mf">3600.0</span>  <span class="c1"># tidal period in seconds</span>
<span class="n">tidal_range</span> <span class="o">=</span> <span class="mf">3.1</span>  <span class="c1"># tidal range in meters</span>
<span class="n">roughness_w</span> <span class="o">=</span> <span class="mf">0.02</span>  <span class="c1"># Manning&#39;s n water</span>
<span class="n">roughness_v</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#manning&#39;s n for veg</span>
<span class="n">mean_sea_level</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># mean sea level in meters</span>
<span class="n">mwd</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># minimum depth for water on areas higher than low tide water surface, meters</span>
<span class="n">nodata_code</span> <span class="o">=</span> <span class="mi">999</span>  <span class="c1"># code for a DEM cell with no valid data</span>
<span class="n">tcrgradeint</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">;</span> <span class="c1"># linear increase in tcr below MLW [pa/m]; not used in current version</span>
</pre></div>
</div>
<div class="section" id="read-the-dem-to-create-a-grid-and-topography-field">
<h3>Read the DEM to create a grid and topography field<a class="headerlink" href="#read-the-dem-to-create-a-grid-and-topography-field" title="Permalink to this headline">¶</a></h3>
<p>The zSW3.asc dataset can be found at:
<a class="reference external" href="https://raw.githubusercontent.com/landlab/landlab/gt/tidal-flow-component/notebooks/tutorials/tidal_flow/zSW3.asc">https://raw.githubusercontent.com/landlab/landlab/gt/tidal-flow-component/notebooks/tutorials/tidal_flow/zSW3.asc</a>
or the CostalTeam github repository.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span> <span class="o">=</span> <span class="n">read_esri_ascii</span><span class="p">(</span><span class="s1">&#39;/Users/ningjiehu/zSW3.asc.txt&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="create-vegetation-grid">
<h3>Create vegetation grid<a class="headerlink" href="#create-vegetation-grid" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">veg</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_zeros</span><span class="p">(</span><span class="s1">&#39;vegetation&#39;</span><span class="p">,</span><span class="n">at</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">);</span>
<span class="n">veg</span><span class="p">[</span><span class="n">z</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">veg_atlink</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">map_max_of_link_nodes_to_link</span><span class="p">(</span><span class="s1">&#39;vegetation&#39;</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;veg_atlink&#39;</span><span class="p">,</span><span class="n">veg_atlink</span><span class="p">,</span><span class="n">at</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">,</span>  <span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="configure-boundaries">
<h3>Configure boundaries<a class="headerlink" href="#configure-boundaries" title="Permalink to this headline">¶</a></h3>
<p>The boundaries contains any nodata nodes, plus any nodes higher than
mean high tide</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="p">[</span><span class="n">z</span><span class="o">==</span><span class="n">nodata_code</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">BC_NODE_IS_CLOSED</span>
<span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="p">[</span><span class="n">z</span><span class="o">&gt;</span><span class="mf">1.8</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">BC_NODE_IS_CLOSED</span>
<span class="n">boundaries_above_msl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="o">==</span><span class="n">grid</span><span class="o">.</span><span class="n">BC_NODE_IS_FIXED_VALUE</span><span class="p">,</span> <span class="n">z</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">grid</span><span class="o">.</span><span class="n">status_at_node</span><span class="p">[</span><span class="n">boundaries_above_msl</span><span class="p">]</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">BC_NODE_IS_CLOSED</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;pre tfc:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_link</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pre</span> <span class="n">tfc</span><span class="p">:</span>
<span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="s1">&#39;vegetation&#39;</span><span class="p">]</span>
<span class="p">[</span><span class="s1">&#39;veg_atlink&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-variable-rougness-as-field-in-grid">
<h3>Generate variable rougness as field in grid<a class="headerlink" href="#generate-variable-rougness-as-field-in-grid" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roughness_at_nodes</span> <span class="o">=</span> <span class="n">roughness_w</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="n">roughness_at_nodes</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="n">roughness_v</span> <span class="c1">#or roughness_at_nodes[veg] = roughness_v</span>
<span class="n">roughness</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">add_zeros</span><span class="p">(</span><span class="s1">&#39;roughness&#39;</span><span class="p">,</span> <span class="n">at</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">)</span>
<span class="n">map_max_of_link_nodes_to_link</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">roughness_at_nodes</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">roughness</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">,</span>  <span class="mf">0.02</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instantiate-a-tidalflowcalculator-component">
<h2>Instantiate a TidalFlowCalculator component<a class="headerlink" href="#instantiate-a-tidalflowcalculator-component" title="Permalink to this headline">¶</a></h2>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tfc</span> <span class="o">=</span> <span class="n">TidalFlowCalculator</span><span class="p">(</span>
        <span class="n">grid</span><span class="p">,</span>
        <span class="n">tidal_period</span><span class="o">=</span><span class="n">tidal_period</span><span class="p">,</span>
        <span class="n">tidal_range</span><span class="o">=</span><span class="n">tidal_range</span><span class="p">,</span>
        <span class="n">roughness</span><span class="o">=</span><span class="s1">&#39;roughness&#39;</span><span class="p">,</span>
        <span class="n">mean_sea_level</span><span class="o">=</span><span class="n">mean_sea_level</span><span class="p">,</span>
        <span class="n">min_water_depth</span><span class="o">=</span><span class="n">mwd</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">tfc</span><span class="o">.</span><span class="n">run_one_step</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">,</span> <span class="s1">&#39;vegetation&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_water__depth&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="assign-critical-shear-stress">
<h3>Assign critical shear stress<a class="headerlink" href="#assign-critical-shear-stress" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tau_cr</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#Critical stress for unvegetated areas</span>
<span class="n">tau_crv</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1">#Critical stress for vegetated areas</span>
</pre></div>
</div>
</div>
<div class="section" id="create-grids">
<h3>Create grids<a class="headerlink" href="#create-grids" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_link</span><span class="p">[</span><span class="s1">&#39;veg_atlink&#39;</span><span class="p">]</span>
<span class="n">tec</span><span class="o">.</span><span class="n">populateGrids</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">tfc</span><span class="p">,</span><span class="n">tau_cr</span><span class="p">,</span><span class="n">tau_crv</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="set-mud-erodability">
<h3>Set mud erodability<a class="headerlink" href="#set-mud-erodability" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mud_erodability</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">);</span>  <span class="c1"># mud erodability kg/m2/s</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-a-single-erosion-step">
<h2>Run a single erosion step<a class="headerlink" href="#run-a-single-erosion-step" title="Permalink to this headline">¶</a></h2>
<p>note this just calculate erosion as a rate, does not update grids</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ero</span> <span class="o">=</span> <span class="n">tec</span><span class="o">.</span><span class="n">totalsedimenterosion_mudsine</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">mud_erodability</span><span class="p">,</span> <span class="n">tidal_range</span><span class="p">,</span> <span class="n">tcrgradeint</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ero</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ero</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.</span>  <span class="mf">0.</span>  <span class="mf">0.</span><span class="p">]</span>
<span class="mf">4.49564123904e-06</span>
</pre></div>
</div>
<div class="section" id="save-original-bathy-topo-maps">
<h3>Save original bathy &amp; topo maps<a class="headerlink" href="#save-original-bathy-topo-maps" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;Initial_topographic_elevation&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">at</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;mean_water__depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;Initial_mean_water_depth&#39;</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">at</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">array</span><span class="p">([</span> <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">,</span>  <span class="mf">0.01</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-erosion-over-timesteps">
<h2>Run erosion over timesteps<a class="headerlink" href="#run-erosion-over-timesteps" title="Permalink to this headline">¶</a></h2>
<p>Now we can do “psuedo morphodynamics”, which allow erosion to happen in
cells, but no sed. transport, no deposition. - In this step, the model
will step through erosion calculation, calculate the new bed elevation,
recalculate the hydrodynamics, and update grids - We can plot every 20
th step, and outputs the minimum bed elevation every step</p>
<div class="section" id="plot-topographic-elevation">
<h3>Plot topographic elevation<a class="headerlink" href="#plot-topographic-elevation" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">ero</span> <span class="o">=</span> <span class="n">tec</span><span class="o">.</span><span class="n">totalsedimenterosion_mudsine</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">mud_erodability</span><span class="p">,</span> <span class="n">tidal_range</span><span class="p">,</span> <span class="n">tcrgradeint</span><span class="p">)</span>
    <span class="n">ero</span> <span class="o">*=</span> <span class="n">tidal_period</span><span class="o">/</span><span class="mi">2</span> <span class="o">*</span> <span class="mi">1</span><span class="o">/</span><span class="mi">2650</span> <span class="c1">#calc erosion over half the tidal cycle converting</span>
    <span class="c1">#print(&#39;ero mean: &#39; + str(ero.mean()))</span>
    <span class="c1">#print(&#39;ero max: &#39; +str(ero.max()))</span>
    <span class="c1">#print(&#39;z min: &#39; +str(z.min()))</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">]</span>
    <span class="n">z</span> <span class="o">-=</span> <span class="n">ero</span> <span class="c1">#update bed elevation</span>
    <span class="c1">#print(&#39;z min post erosion: &#39; +str(z.min()))</span>
    <span class="n">tfc</span><span class="o">.</span><span class="n">run_one_step</span><span class="p">()</span>
    <span class="n">tec</span><span class="o">.</span><span class="n">updategrids</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">tfc</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="k">20</span>==0:
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span><span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;topographic__elevation&#39;</span><span class="p">],</span> <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Topographic elevation (m), Step = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/output_36_0.png" src="../../_images/output_36_0.png" />
<img alt="../../_images/output_36_1.png" src="../../_images/output_36_1.png" />
<img alt="../../_images/output_36_2.png" src="../../_images/output_36_2.png" />
<img alt="../../_images/output_36_3.png" src="../../_images/output_36_3.png" />
<img alt="../../_images/output_36_4.png" src="../../_images/output_36_4.png" />
<img alt="../../_images/output_36_5.png" src="../../_images/output_36_5.png" />
</div>
<div class="section" id="plot-final-water-depths">
<h3>Plot final water depths<a class="headerlink" href="#plot-final-water-depths" title="Permalink to this headline">¶</a></h3>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;mean_water__depth&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Water depth at end of simulation (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;Initial_mean_water_depth&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Water depth Initially (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">g</span> <span class="o">=</span>  <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;mean_water__depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span>
<span class="n">go</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;Initial_mean_water_depth&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">();</span>
<span class="n">gper</span> <span class="o">=</span> <span class="p">(</span><span class="n">g</span><span class="o">-</span><span class="n">go</span><span class="p">)</span><span class="o">/</span><span class="n">go</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">grid</span><span class="o">.</span><span class="n">add_field</span><span class="p">(</span><span class="s1">&#39;Percent Change water depth&#39;</span><span class="p">,</span><span class="n">gper</span><span class="p">,</span><span class="n">at</span><span class="o">=</span><span class="s1">&#39;node&#39;</span><span class="p">,</span><span class="n">clobber</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">imshow_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">,</span> <span class="n">grid</span><span class="o">.</span><span class="n">at_node</span><span class="p">[</span><span class="s1">&#39;Percent Change water depth&#39;</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">color_for_closed</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Percent Change of Water depth over simulation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;Distance (m)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/output_38_1.png" src="../../_images/output_38_1.png" />
<img alt="../../_images/output_38_2.png" src="../../_images/output_38_2.png" />
<img alt="../../_images/output_38_3.png" src="../../_images/output_38_3.png" />
</div>
</div>
</div>
<div class="section" id="questions-to-think-about">
<h1>Questions to think about<a class="headerlink" href="#questions-to-think-about" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><p>Now you can see where there is high erosion occuring - why might this
spot have erosion? What might change the pattern and location of
erosion?</p></li>
<li><p>What variables can you change or play with to produce a different
response in this landscape?</p></li>
<li><p>What are key things missing from this model? What are we not
modeling?</p></li>
<li><p>looking at the percent change in water level is helpful. How can you
look at percent change of elevation or flood velocities in the
landscape? What code would need to be added?</p></li>
</ol>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../HomogeneousField2D/HomogeneousField2D.html" class="btn btn-neutral float-right" title="Tides on a simple 2D field" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../index.html" class="btn btn-neutral float-left" title="Examples" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, CoastalTeam

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>